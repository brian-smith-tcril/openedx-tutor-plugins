
# Add the lti store filter to the filter list, creating the configuration if it doesn't
# exist but updating it if it does exist.

_filter_name = 'org.openedx.xblock.lti_consumer.configuration.listed.v1'

# Get or create the filter and pipeline list for the filter we care about
_filter_to_update = OPEN_EDX_FILTERS_CONFIG.get(_filter_name, {})
_pipeline_list = _filter_to_update.get('pipeline', [])

# Update the list to add our new filter.
_pipeline_list.append('lti_store.pipelines.GetLtiConfigurations')

# Replace the existing setting with the updated version from the bottom up.
# We do this because we might have created the object via the gets above. In
# which case, the parent object would not have a reference to it.
_filter_to_update['pipeline'] = _pipeline_list
# Just override this, we don't care if it's there or not.
_filter_to_update['fail_silently'] = False
OPEN_EDX_FILTERS_CONFIG[_filter_name] = _filter_to_update

